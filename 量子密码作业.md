# 量子安全直接通信协议设计与安全分析中的 CNOT 门应用研究

## 摘要

本报告旨在深入研究受控非门（CNOT 门）在量子安全直接通信（QSDC）领域中的关键作用。报告首先概述了 QSDC 的基本原理以及 CNOT 门的操作特性。随后，分析聚焦于两类特定的 QSDC 协议及其相关的、以 CNOT 门为核心的攻击方式。

第一部分回顾了 LM05 双向 QSDC 协议，并探讨了量子中间人（QMM）攻击，强调了 CNOT 门在窃听者量子信息处理能力中的隐性必要性。第二部分详细阐述了"双 CNOT 攻击"，这是一种针对特定半量子协议和类量子密钥分发协议的显著漏洞，揭示了两次策略性部署的 CNOT 操作如何使窃听者在往往不被察觉的情况下提取信息。

讨论着重强调了 CNOT 门的双重特性：它既是协议内合法量子操作（如产生纠缠和编码）不可或缺的组成部分，同时也是恶意行为者进行攻击的强大工具。报告最后对这些发现进行了总结，强调了当前迫切需要能够抵御拥有包括执行 CNOT 操作在内的量子计算能力的对手的鲁棒协议设计和全面的安全分析。

## 第一章：量子安全直接通信（QSDC）与受控非门（CNOT）基础

### 1.1 量子安全直接通信（QSDC）概述

量子安全直接通信（QSDC）是一种新兴的量子通信范式，其目标是在量子信道上直接传输秘密信息，而无需预先共享密钥。QSDC 利用量子态对信息进行编码，其安全性基于量子物理学的基本原理，例如量子不可克隆定理，确保任何窃听行为都会因扰动量子态而被发现。

正如相关研究所述，"QSDC 利用量子态在有噪声、有损耗和被窃听的量子信道上安全可靠地传输信息，并已被证明是信息论安全的"。此外，"QSDC 通过在量子态中编码信息，确保了在有噪声和窃听信道上的安全可靠通信"。

#### QSDC 与 QKD 的区别

QSDC 与量子密钥分发（QKD）虽然都利用量子力学增强通信安全，但其目标有所不同：

- **QKD**：主要目的是安全地协商和分发密钥，这些密钥随后用于经典密码系统进行加密
- **QSDC**：直接利用量子态本身来传输秘密消息，旨在实现"无需预先共享密钥的安全通信"

在 QSDC 协议中，通常需要一个认证的经典信道。这个经典信道对于完成窃听检测、错误校正等辅助任务至关重要。例如，合法用户"通过量子信道和认证的经典信道分别传输量子和经典信息"。

### 1.2 量子信息中的受控非门（CNOT）

受控非门（CNOT 门）是量子计算中一种基础性的双量子比特逻辑门。它包含一个"控制量子比特"（control qubit）和一个"目标量子比特"（target qubit）。

**CNOT 门的功能：**
- 当且仅当控制量子比特处于 |1⟩ 态时，目标量子比特的状态会翻转（即 |0⟩ 变为 |1⟩，|1⟩ 变为 |0⟩）
- 如果控制量子比特处于 |0⟩ 态，则目标量子比特的状态保持不变

CNOT 门的操作可以用一个 4×4 的幺正矩阵来描述。其对计算基矢 |00⟩, |01⟩, |10⟩, |11⟩ 的作用如下：

```
CNOT|00⟩ = |00⟩
CNOT|01⟩ = |01⟩
CNOT|10⟩ = |11⟩
CNOT|11⟩ = |10⟩
```

**表 1.1: CNOT 门操作真值表**

| 输入态 (控制, 目标) | 输出态 (控制, 目标) |
|:------------------:|:------------------:|
| \|00⟩                | \|00⟩                |
| \|01⟩                | \|01⟩                |
| \|10⟩                | \|11⟩                |
| \|11⟩                | \|10⟩                |

#### CNOT 门的重要性

CNOT 门与单量子比特旋转门一起构成了量子门的一个通用集合，这意味着任何量子计算都可以分解为这些门的一系列操作。它在产生量子比特间的纠缠、实现量子算法和量子纠错码等方面扮演着至关重要的角色。

例如，有研究提出了一种"仅用双量子比特 CNOT 门和单量子比特哈达玛门设计的五量子比特码的简单量子线路"。

#### NISQ 时代的考量

在噪声中等规模量子（NISQ）设备时代，CNOT 门的数量和保真度对整体线路性能有显著影响：
- "最小化双量子比特门时间至关重要"
- "减少双量子比特门的数量对于最小化总线路非保真度至关重要"

#### CNOT 门的双重角色

CNOT 门在量子通信和计算中扮演着双重角色：
1. **建设性角色**：构建协议和算法的基石
2. **潜在威胁**：可能成为窃听者利用的工具

其产生纠缠和执行条件操作的能力对于构建量子协议至关重要，但正如后续章节将展示的，如果窃听者能够将其应用于传输中或存储的量子比特，这种相同的能力也会使其成为一个强大的攻击工具。

在当前的 NISQ 时代，对 CNOT 门数量和保真度的优化需求也带来了新的考量：
- 为了提高计算速度和保真度而强调最小化 CNOT 门数量，可能会在不经意间影响协议设计的选择
- 具有较少 CNOT 门的更简单协议可能更容易进行安全性分析，但也可能使攻击者更容易建模或针对性攻击

这揭示了在实际可实现性与针对所有可想象攻击（包括基于 CNOT 的攻击）的全面安全性之间可能存在的张力。

## 第二章：双向 QSDC 协议分析：LM05 协议与量子中间人（QMM）攻击

### 2.1 LM05 协议回顾

LM05 协议由 Lucamarini 和 Mancini 于 2005 年提出，是一种双向 QSDC 协议。该协议的特点包括：

- 利用非正交态进行通信
- 不依赖纠缠来实现确定性通信
- 既可用于直接通信，也可用于密钥分发
- 旨在实现无条件安全和高传输效率

其"双向"特性意味着量子比特会从一个用户传输到另一个用户，然后再返回。"LM05 协议使用单光子"。

#### 协议步骤

虽然现有资料未提供 LM05 协议的完整分步描述，但双向协议通常包含以下概念性步骤：

1. 发送方（例如 Alice）制备并发送量子比特
2. 接收方（例如 Bob）对接收到的量子比特执行操作（例如编码信息或执行控制操作）
3. 量子比特被发送回初始发送方
4. 使用一部分量子比特（控制模式）进行安全检查，而其余量子比特（消息模式）则携带秘密信息

相关研究在讨论 LM05 协议时提到了"消息模式 (MM)"和"控制模式 (CM)"，这符合此类协议的典型特征。

### 2.2 CNOT 门在 LM05 设计与分析中的应用（推断）

LM05 协议的原始描述侧重于使用非正交态进行单量子比特操作，并未明确在其核心设计中详细说明 CNOT 门的使用。然而，当考虑到复杂的窃听策略，特别是量子中间人（QMM）攻击时，CNOT 操作在其安全性分析中变得高度相关。

如果窃听者（Eve）要成功地冒充合法用户并中继消息，她将需要具备量子处理能力，而 CNOT 门是实现诸如状态复制（针对已获知的经典信息）或将其探测器与通信信道纠缠等操作的基础。

### 2.3 针对 LM05 的量子中间人（QMM）攻击

QMM 攻击是一种针对双向通信协议的复杂攻击策略。在针对 LM05 协议的 QMM 攻击中，窃听者 Eve 的基本步骤如下：

#### 攻击步骤

1. **截获与存储**：Eve 截获从发送方（例如 Bob）发出的量子比特，将这些量子比特存储在她的量子存储器中
2. **冒充发送**：Eve 制备自己的量子比特，冒充 Bob 将这些量子比特发送给另一方（Alice）
3. **截获编码信息**：Alice 会在 Eve 的量子比特上编码她的消息。Eve 再次截获这些携带了 Alice 消息的量子比特
4. **解码与重编码**：Eve 解码出 Alice 的消息，然后将获取到的消息编码到她之前存储的 Bob 的原始量子比特上
5. **转发**：将这些量子比特发送给 Bob

#### 攻击特点

在这种攻击下，一个显著的特点是"在消息模式下因此没有扰动，发送者和接收者之间的互信息总是恒定且等于 1，窃听者复制的消息总是真实的"。

这意味着：
- 仅通过检查消息模式下的量子比特，合法用户可能无法察觉到 Eve 的存在
- 检测只能在控制模式下进行

#### CNOT 门在 QMM 攻击中的作用

尽管描述 QMM 攻击的文献主要阐述了 Eve 行动的结果，而非其具体的量子线路，但 CNOT 门在 Eve 的 QMM 工具箱中扮演着至关重要的角色。

为了"解码 Alice 的消息"并"将其编码到 Bob 保存的量子比特上"，Eve 必须执行量子操作。CNOT 门（作为通用门集合的一部分）将是实现以下功能的关键工具：

- **条件逻辑**：根据 Eve 从 Alice 处解码出的消息比特，对 Bob 的量子比特执行条件操作
- **状态制备/转换**：制备特定状态以发送给 Alice，或转换 Bob 存储的量子比特

例如，如果 Eve 从 Alice 处获知一个经典比特 'm'，并需要在 Bob 的量子比特 |ψ⟩_B 上应用操作 U_m，她可能会使用一个受控 U 操作来实现，而这种操作可以分解为 CNOT 门和单量子比特门。

#### 攻击的安全影响

值得注意的是，关于 LM05 协议 QMM 攻击的一篇论文存在撤稿说明，该说明因分析扰动方面的缺陷而质疑了原先关于攻击不可检测性的结论。

QMM 攻击的威胁突显了几个重要问题：

1. **量子存储威胁**：攻击过程依赖于 Eve 能够存储量子态并对其执行复杂的量子操作
2. **控制机制重要性**："在消息模式下无法检测到"QMM 攻击，检测"仅依赖于控制模式"，强调了控制/检查机制设计的极端重要性
3. **双向协议的脆弱性**：双向协议中量子比特来回传输的特性，为 Eve 提供了多个拦截机会

## 第三章：针对（半）量子安全直接通信协议的双 CNOT 攻击

### 3.1 目标协议简介

"双 CNOT 攻击"已被确定为主要针对半量子安全直接通信（SQSDC）协议或某些具有相似结构的 QKD 协议的重大威胁。

#### 半量子协议特点

SQSDC 协议旨在降低对量子资源的需求，通常涉及：
- 一个"量子"用户（具有完整量子操作能力）
- 一个量子能力有限的"经典"用户（例如，只能在一种基上测量或反射量子比特）

例如，"2017 年，Gu 等人发现了一种针对 Zou 和 Qiu 的 SQSDC 协议的新型攻击——双 CNOT 攻击"。

#### 易受攻击协议的共同特征

容易受到双 CNOT 攻击的协议通常具有以下流程特征：

1. 量子比特从一方（例如，量子用户 Alice）发送到另一方（例如，经典用户 Bob）
2. 第二方（Bob）执行某些操作（例如，反射量子比特，或根据其经典比特测量并重新发送一个新的量子比特）
3. 量子比特（或新的量子比特）被发送回第一方（Alice）
4. 执行安全检查

### 3.2 双 CNOT 攻击的详细机制

双 CNOT 攻击的核心在于窃听者 Eve 利用一个她自己制备的辅助量子比特（通常处于 |0⟩ 态）并执行两次 CNOT 操作。

#### 攻击步骤

1. **第一次 CNOT 操作**：
   - Eve 截获从 Alice 发送给 Bob 的量子比特
   - 她以 Alice 的量子比特为控制位，以自己的辅助量子比特为目标位，执行一次 CNOT 操作
   - 将（可能已改变的）Alice 的量子比特发送给 Bob，同时保存自己的辅助量子比特

2. **Bob 的操作**：
   - Bob 根据协议规定执行其操作（例如，反射量子比特，或者测量后重新发送）

3. **第二次 CNOT 操作**：
   - Eve 截获从 Bob 返回（目的地为 Alice）的量子比特
   - 她再次以传输中的量子比特为控制位，以她之前存储的同一个辅助量子比特为目标位，执行第二次 CNOT 操作
   - 将传输中的量子比特转发给 Alice

4. **Eve 的测量**：
   - Eve 测量她的辅助量子比特
   - 根据协议的具体细节，这次测量的结果可以揭示关于 Bob 操作或 Alice 原始发送状态的信息

#### 攻击的巧妙性

双 CNOT 攻击的巧妙之处在于其设计往往能使 Alice 最终接收到的状态（经过 Bob 的操作和 Eve 的两次 CNOT 操作后）与诚实执行情况下应接收到的状态相同，从而在安全检查过程中逃避检测。

然而，Eve 的辅助量子比特的状态会根据中间操作发生变化，从而使她能够提取信息。

### 3.3 CNOT 门在攻击中的明确角色和应用

在双 CNOT 攻击中，CNOT 门扮演了几个关键角色：

#### 1. 纠缠与解纠缠探针
第一次 CNOT 操作将 Eve 的辅助量子比特与携带信息的信号量子比特纠缠起来。辅助量子比特的状态因此与控制量子比特的状态相关联。

#### 2. 信息提取
在 Bob 的操作修改了控制量子比特之后，第二次 CNOT 操作有效地将关于此修改的信息"转移"到 Eve 的辅助量子比特上。

#### 3. 恢复状态以实现不可检测性
第二次 CNOT 操作通常对于"撤销"第一次 CNOT 操作对主要信息携带量子比特路径的影响至关重要，从而使 Alice 接收到的量子比特看起来未受 Eve 干扰。

#### 状态演化示例

假设 Alice 发送 |0⟩_A 或 |1⟩_A，Eve 的辅助量子比特初始为 |0⟩_E：

1. **初始状态**：Alice 发送 q_A，Eve 拥有 q_E = |0⟩_E
2. **第一次 CNOT**：Eve 对 (q_A, q_E) 执行 CNOT（q_A 为控制，q_E 为目标）
   - 若 q_A = |0⟩_A，则系统变为 |0⟩_A|0⟩_E
   - 若 q_A = |1⟩_A，则系统变为 |1⟩_A|1⟩_E
3. **Bob 的操作**：假设 Bob 的操作是根据其秘密比特进行反射或翻转
4. **第二次 CNOT**：Eve 截获返回的量子比特并执行第二次 CNOT
5. **Eve 的测量**：Eve 测量她的辅助量子比特获得信息

**表 3.1: 双 CNOT 攻击场景下的状态演化示例**

| Alice发送 | Eve初始 | 第一次CNOT后 | Bob操作后 | 第二次CNOT后 | Eve可推断信息 |
|:--------:|:-------:|:-----------:|:--------:|:-----------:|:------------:|
| \|0⟩_A   | \|0⟩_E  | (\|0⟩_A,\|0⟩_E) | 依赖于b_B | 相应变化 | Bob的比特信息 |
| \|1⟩_A   | \|0⟩_E  | (\|1⟩_A,\|1⟩_E) | 依赖于b_B | 相应变化 | Bob的比特信息 |

#### 攻击的深层含义	

1. **利用可预测响应**：双 CNOT 攻击往往利用了 SQSDC/SQKD 协议中"经典"或"半量子"用户有限的能力或可预测的响应

2. **信息"洗钱"**：双 CNOT 攻击有效地允许 Eve 在主信道上不留下可检测痕迹的情况下，将量子信道中的信息"复制"到其本地辅助量子比特上

3. **模板性质**：虽然"双 CNOT"这个名称是特定的，但其基本原理涉及使用受控操作来探测和提取信息，是一个可以被调整的模板

## 第四章：设计与分析原理：QSDC 安全中的 CNOT 门

### 4.1 包含/防范基于 CNOT 操作的 QSDC 协议设计原理

为了设计能够抵御基于 CNOT 门攻击的 QSDC 协议，需要遵循以下原则：

#### 1. 鲁棒的窃听检测机制
协议必须包含严格的安全检查机制，这些机制应对基于 CNOT 的攻击可能引入的微妙扰动敏感。这可能涉及：
- 使用多种基进行检查
- 使用诱骗态
- 验证那些会被 Eve 的 CNOT 交互破坏的相关性

#### 2. 最小化可预测操作
对于涉及能力受限用户的协议（如 SQSDC），设计应避免过于可预测的响应：
- 在"经典"用户允许的操作中引入更多的随机性或复杂性
- 使 Eve 更难设计出干净利落、不可检测的 CNOT 攻击

#### 3. 认证与完整性
对消息和参与者的强认证至关重要：
- 量子身份认证
- 确保 Eve 无法在不被检测到的情况下修改经典控制消息

#### 4. 量子态与编码的选择
使用那些对 Eve 可能尝试用 CNOT 进行的特定转换具有更强鲁棒性的量子态或编码方案：
- 使用纠缠纯化来建立更高保真度的纠缠态
- 使 Eve 篡改纠缠系统部分的企图更容易被检测到

### 4.2 安全性分析原理：识别和缓解基于 CNOT 的漏洞

在分析 QSDC 协议的安全性时，应遵循以下原则：

#### 1. 假设强大的对手
安全性证明应考虑到一个能够执行通用量子操作（包括任意 CNOT 门序列）并拥有量子存储器的对手（Eve）。

#### 2. 分析信息向 Eve 辅助量子比特的流动
对于任何提议的协议，都需要分析如果 Eve 在通信量子比特和她的辅助量子比特之间执行 CNOT 操作，信息在各个阶段如何泄漏给窃听者的辅助系统。

#### 3. 扰动与信息权衡
量化 Eve 使用基于 CNOT 的策略可以获得的信息与她不可避免地造成的扰动之间的权衡。安全协议的目标是确保 Eve 的任何显著信息增益都会导致可检测水平的扰动。

#### 4. 考虑多阶段攻击
像双 CNOT 这样的攻击涉及多次交互。安全性分析必须考虑整个协议流程以及 Eve 操作的累积效应。

### 4.3 对比洞察：CNOT 的双重角色

CNOT 门在 QSDC 协议的设计和安全性分析中展现出显著的双重性：

#### CNOT 作为建设性的协议元素
在合法的协议操作中，CNOT 门对于以下功能必不可少：
- 创建纠缠态（例如 EPR 对、GHZ 态）
- 条件编码信息
- 用于保护传输量子比特的量子纠错码

#### CNOT 作为窃听者的漏洞利用工具
正如 QMM 攻击和双 CNOT 攻击所展示的，Eve 可以使用 CNOT 门来实现：
- 将其探针与信号量子比特纠缠
- 通过条件翻转复制经典信息
- 执行受控操作以在不被检测到的情况下提取信息

#### 安全领域的"军备竞赛"
量子密码学领域存在一种持续的"军备竞赛"：
1. 新的协议被提出
2. 漏洞被发现（通常利用像 CNOT 这样的基本门）
3. 防御措施或新的协议被开发出来

由于 CNOT 门的基础性，它很可能仍然是攻击和防御策略中的关键要素。

#### 协议逻辑的重要性
所分析的攻击不仅仅是"监听"信道；它们主动参与并利用协议的逻辑和交互步骤。这表明安全性不仅仅关乎信道本身，更关乎整个协议逻辑的严密性。

## 第五章：结论

### 5.1 CNOT 门重要性回顾

CNOT 门在量子安全直接通信领域扮演着至关重要的双重角色：

- **建设性角色**：它是 QSDC 协议中实现合法量子操作（如产生纠缠、信息编码和量子纠错）的基础构件，为协议的正常运行提供了必要的量子逻辑功能
- **潜在威胁**：它也为窃听者提供了一个强大而通用的工具，可用于设计和执行复杂的攻击策略

### 5.2 已分析攻击及其影响总结

本报告分析了两种典型的利用 CNOT 门的攻击：

1. **量子中间人（QMM）攻击**：针对 LM05 等双向协议，CNOT 门是 Eve 实现其复杂量子信息处理的隐含前提
2. **双 CNOT 攻击**：针对半量子和类 QKD 协议，Eve 通过两次精确的 CNOT 操作来窃取信息

这些攻击案例清晰地表明：
- CNOT 门是攻击者实现其目标的核心工具
- 这些攻击往往难以被传统的安全检测机制发现
- 在协议设计阶段就必须充分考虑对手可能利用 CNOT 门进行恶意操作的可能性

### 5.3 未来研究方向或对策

为应对这些高级攻击，未来的研究方向应包括：

#### 1. 更强的协议设计
- **设备无关 QSDC（DI-QSDC）**：旨在减少对用户设备可信度的假设，从而可能从根本上消除某些基于设备漏洞的攻击途径
- **量子纠错码和容错计算**：对于减轻可能被基于 CNOT 的攻击利用的操作性漏洞具有重要意义

#### 2. NISQ 时代的挑战
在当前的 NISQ 时代，实际量子设备的噪声和有限相干时间为协议的实现带来了挑战：
- 如何在这些实际限制下设计既安全又高效的 QSDC 协议
- 确保其能够抵御包括 CNOT 攻击在内的各种威胁

#### 3. 理论与实践结合
未来研究需要理论研究与实验验证的紧密结合，不断推动 QSDC 技术走向成熟和实用化。

---

## 参考文献

1. Coggins, M. (2019). CNOT gate tutorial with Code. *Quantum Computing UK*.
2. Pavicic, M. (2018). Figure 3: LM05 protocol (a) Message mode (MM) according to . Fig. 1. (b) Control mode.... *ResearchGate*.
3. Shukla, A., et al. (2024). A Review of Semi-Quantum Secure Direct Communication Protocols. *INFOCOMP Journal of Computer Science*.
4. Gu, J., & Hwang, T. (2020). Double C-NOT attack on a single-state semi-quantum key distribution protocol and its improvement. *arXiv:2009.12535*.
5. Zhu, F., et al. (2020). Figure 3: Principle of DL04 QSDC protocol. *ResearchGate*.
6. Zhang, Y., et al. (2024). Two Novel Semi-Quantum Secure Direct Communication Protocols in IoT. *Sensors*, 24(24), 7990.
7. User "user4961" & "Diego Herrera". (2018-2021). BB84 attack with entangled qubits example. *Quantum Computing Stack Exchange*.
8. Lucamarini, M., & Mancini, S. (2004). Secure Deterministic Communication Without Entanglement. *arXiv:quant-ph/0405083*.
9. Kam, C.-F., & Kuo, E.-J. (2025). Quantum-Secured Device-Independent Global Positioning System. *arXiv preprint arXiv:2504.08465*.
10. Singh, H., et al. (2024). Device-Independent Quantum Secure Direct Communication with User Authentication on IBM's Quantum Hardware. *arXiv preprint arXiv:2409.10427*.
11. Yin, Z., et al. (2023). Device-independent quantum secure direct communication with practical single photon sources. *arXiv preprint arXiv:2303.15858*.
12. Ye, T., & Jiang, L. (2024). Secure channel capacity of quantum secure direct communication with an improved noise-coherent-unknown-measurement model. *Science China Physics, Mechanics & Astronomy*.
13. Hwang, W.-Y., et al. (2014). Bidirectional Quantum Secure Direct Communication by Using a Genuine N-Particle Entangled State. *PLoS ONE*, 9(7), e101650.
14. Long, G. L., et al. (2023). Free-space quantum secure direct communication: basics, progress, and outlook. *Frontiers of Physics*, 18(1), 12307.
15. Long, G. L. (2024). Quantum secure direct communication. *National Science Review*.
16. Pirnay, N., et al. (2024). Two-Factor Authenticated BB84 Quantum Key Distribution. *arXiv preprint arXiv:2407.03119*.
17. Pavicic, M. (2021). How Secure Are Two-Way Ping-Pong and LM05 QKD Protocols under a Man-in-the-Middle Attack?. *Entropy*, 23(2), 163.
18. Pavicic, M. (2021). How Secure Are Two-Way Ping-Pong and LM05 QKD Protocols under a Man-in-the-Middle Attack?. *arXiv:2102.00126*.
19. Lucamarini, M., & Mancini, S. (2005). Secure Deterministic Communication without Entanglement. *Physical Review Letters*, 94(14), 140501. 