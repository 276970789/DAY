# 📝 PlanFlow 日记功能设计方案

## 🎯 功能概述

为PlanFlow添加灵活的日记功能，支持不定期写作，与任务管理系统完美融合。

## 🏗️ 整体架构

### 1. 数据结构设计
```javascript
const diary = {
    id: 'diary_20250610',
    date: '2025-06-10',
    title: '今日感想',
    content: '今天完成了很多任务...',
    mood: 'happy', // happy, sad, normal, excited, tired
    weather: 'sunny', // sunny, cloudy, rainy, snowy
    tags: ['工作', '学习', '生活'],
    wordCount: 156,
    createdAt: '2025-06-10T20:30:00',
    updatedAt: '2025-06-10T21:15:00',
    isPrivate: true,
    attachments: [] // 可选：图片、文件等
}
```

### 2. 界面设计方案

#### 方案A：独立视图（推荐）
```
📊 今日概览
📅 日历视图  
✅ 任务列表
📋 项目管理
📝 我的日记  ← 新增
```

#### 方案B：集成到日历
- 在日历视图中每个日期显示日记图标
- 点击查看/编写当日日记
- 更紧密的时间关联

#### 方案C：浮动写作（快速记录）
- 右下角浮动按钮
- 快速弹出写作窗口
- 适合临时想法记录

## 🎨 用户界面设计

### 1. 日记列表视图
```
┌─────────────────────────────────────────┐
│ 📝 我的日记                      ✏️ 写日记 │
├─────────────────────────────────────────┤
│ 🔍 搜索日记...                           │
├─────────────────────────────────────────┤
│ 📅 按时间排序 ▼  🏷️ 按标签筛选 ▼      │
├─────────────────────────────────────────┤
│ ┌─────────────────────────────────────┐ │
│ │ 📅 2025年6月10日 ☀️ 😊               │ │
│ │ 今日工作总结                          │ │
│ │ 今天完成了日历功能的优化，用户...     │ │
│ │ 📝 156字 🏷️ 工作 学习                │ │
│ └─────────────────────────────────────┘ │
│ ┌─────────────────────────────────────┐ │
│ │ 📅 2025年6月8日 ⛅ 😐                │ │
│ │ 周末思考                             │ │
│ │ 最近在思考如何平衡工作与生活...       │ │
│ │ 📝 89字 🏷️ 生活 思考                 │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

### 2. 日记编写界面
```
┌─────────────────────────────────────────┐
│ ← 返回  📅 2025年6月10日        💾 保存  │
├─────────────────────────────────────────┤
│ 📝 标题：今日工作总结                    │
├─────────────────────────────────────────┤
│ 心情：😊 😐 😞 😴 🎉                    │
│ 天气：☀️ ⛅ 🌧️ ❄️                      │
│ 标签：#工作 #学习 #生活                  │
├─────────────────────────────────────────┤
│ ┌─────────────────────────────────────┐ │
│ │ 今天完成了PlanFlow的日历功能优化，   │ │
│ │ 用户反馈很积极。日历现在可以显示     │ │
│ │ 任务名称，大大提升了使用体验。       │ │
│ │                                     │ │
│ │ 接下来计划：                        │ │
│ │ 1. 添加拖拽功能                     │ │
│ │ 2. 日记系统                         │ │
│ │ 3. 数据导出功能                     │ │
│ │                                     │ │
│ └─────────────────────────────────────┘ │
├─────────────────────────────────────────┤
│ 字数：156  📎 添加附件  🔒 私密日记      │
└─────────────────────────────────────────┘
```

## 🚀 功能特性

### 核心功能
- ✅ **自由写作**：不强制每天写，随时记录
- ✅ **富文本编辑**：支持格式化、标题、列表
- ✅ **心情记录**：5种表情快速标记
- ✅ **天气记录**：4种天气图标
- ✅ **标签系统**：自定义标签，便于分类
- ✅ **搜索功能**：标题、内容、标签全文搜索
- ✅ **时间统计**：字数统计、写作频率

### 高级功能
- 🔄 **与任务关联**：可以关联当日任务
- 📊 **写作统计**：月度写作统计图表
- 📤 **导出功能**：支持导出为Markdown/PDF
- 🔒 **隐私保护**：可设置私密日记
- 📱 **快速记录**：支持快捷键快速开始写作
- 🎨 **主题定制**：日记界面个性化

## 📅 与现有功能的整合

### 1. 日历视图整合
```javascript
// 在日历单元格中显示日记图标
if (hasDiary(cellDate)) {
    const diaryIcon = document.createElement('div');
    diaryIcon.className = 'diary-indicator';
    diaryIcon.innerHTML = '📝';
    diaryIcon.title = '今日有日记';
    cell.appendChild(diaryIcon);
}
```

### 2. 今日概览整合
```javascript
// 在今日概览中显示
const todayDiary = getDiaryForDate(today);
if (todayDiary) {
    // 显示今日日记摘要
} else {
    // 显示"今天还没写日记"提示
}
```

### 3. 任务关联
```javascript
// 在任务完成时提示写日记
function onTaskComplete() {
    const completedToday = getCompletedTasksToday().length;
    if (completedToday >= 3 && !hasWrittenDiaryToday()) {
        showDiaryReminder();
    }
}
```

## 🛠️ 技术实现方案

### 1. 数据存储
```javascript
// 扩展现有数据结构
let appData = {
    tasks: [],
    projects: [],
    diaries: [], // 新增
    diarySettings: {
        autoRemind: true,
        reminderTime: '21:00',
        defaultPrivate: false
    }
};
```

### 2. 核心函数
```javascript
// 日记管理函数
function createDiary(date, title, content) { }
function updateDiary(id, updates) { }
function deleteDiary(id) { }
function searchDiaries(query) { }
function getDiariesByDateRange(start, end) { }
function exportDiaries(format) { }
```

### 3. UI组件
```javascript
// React风格的组件设计（但用原生JS实现）
- DiaryList: 日记列表
- DiaryEditor: 日记编辑器
- DiaryCard: 日记卡片
- MoodSelector: 心情选择器
- TagInput: 标签输入
- DiaryStats: 统计图表
```

## 📊 用户体验设计

### 1. 写作体验
- **无压力**：不强制每天写，随时想写就写
- **快速启动**：3秒内开始写作
- **自动保存**：输入即保存，不丢失内容
- **专注模式**：全屏写作，沉浸体验

### 2. 阅读体验
- **时间轴浏览**：按时间顺序浏览所有日记
- **快速预览**：卡片式展示，点击展开
- **搜索定位**：快速找到想要的内容
- **回忆功能**："一年前的今天"

### 3. 数据安全
- **本地存储**：数据始终在本地
- **定期备份**：自动备份到指定目录
- **加密选项**：敏感内容可以加密
- **导出自由**：随时导出所有数据

## 🎯 实施计划

### 阶段1：基础功能（1-2天）
- [x] 数据结构设计
- [ ] 基础UI界面
- [ ] 简单编辑器
- [ ] 数据保存加载

### 阶段2：完善功能（2-3天）
- [ ] 心情和天气记录
- [ ] 标签系统
- [ ] 搜索功能
- [ ] 与日历整合

### 阶段3：高级功能（3-4天）
- [ ] 富文本编辑
- [ ] 统计图表
- [ ] 导出功能
- [ ] 个性化设置

## 💡 创新亮点

1. **任务驱动提醒**：完成一定数量任务后智能提醒写日记
2. **情感分析**：基于文本分析情感趋势
3. **生产力关联**：日记与任务完成情况关联分析
4. **智能摘要**：自动生成日记摘要和关键词
5. **写作统计**：详细的写作习惯分析

## 🎨 界面预览

采用与现有界面一致的简洁风格：
- **主色调**：沿用蓝色主题 #1976d2
- **卡片设计**：圆角、阴影、简洁
- **图标系统**：表情符号 + 简单图标
- **响应式**：适配不同窗口大小
- **动画效果**：轻微过渡，不影响性能

## 📝 结论

这个日记功能设计兼顾了功能性和简洁性，与现有任务管理系统形成很好的互补。用户可以在完成任务的同时记录心得，形成完整的个人管理闭环。

**推荐实施顺序**：
1. 先实现任务拖拽功能（用户急需）
2. 再实现日记基础功能
3. 最后完善高级特性

这样既满足用户的即时需求，又为未来功能扩展留下空间。 